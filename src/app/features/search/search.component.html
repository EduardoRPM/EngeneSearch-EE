<div class="flex flex-col gap-6 p-6">
  <div *ngIf="!hasResults" class="flex flex-col items-center justify-center text-center gap-4 py-16">
    <div class="text-4xl md:text-6xl w-full md:w-1/2">AI Assistant to encounter related papers</div>
    <div class="text-xl md:text-2xl w-full md:w-1/2 text-gray-600">
      Write about a topic you know or make your own prompt
    </div>
  </div>

  <div class="flex flex-col gap-4 max-w-5xl mx-auto w-full">
    <div class="flex flex-col gap-2">
      <app-search-assist
        [sourceText]="input"
        (selectKeyword)="handleKeywordSelect($event)"
        (suggestionsChange)="handleSuggestionsChange($event)"
      ></app-search-assist>
      <div *ngIf="selectedKeywords.length" class="flex flex-wrap gap-2 text-sm text-gray-700">
        <span *ngFor="let keyword of selectedKeywords" class="px-3 py-1 rounded-full bg-green-100 text-green-800 border border-green-300">
          {{ keyword }}
        </span>
      </div>
    </div>

    <div class="relative">
      <textarea
        placeholder="Give me any task to work on..."
        class="w-full p-4 pr-16 border-2 border-gray-300 rounded-xl resize-none focus:outline-none focus:ring-2 focus:ring-green-300"
        rows="3"
        [(ngModel)]="input"
        (keydown)="handleKeydown($event)"
      ></textarea>
      <button
        type="button"
        class="absolute bottom-3 right-3 p-3 bg-gray-500 hover:bg-gray-600 rounded-lg text-white disabled:opacity-60"
        [disabled]="isSearching"
        (click)="handleSearch()"
        aria-label="Buscar artÃ­culos"
      >
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" class="w-5 h-5">
          <path stroke-linecap="round" stroke-linejoin="round" d="M4.5 10.5 12 3m0 0 7.5 7.5M12 3v18" />
        </svg>
      </button>
    </div>

    <div *ngIf="searchError" class="text-sm text-red-600">{{ searchError }}</div>
    <div *ngIf="favoriteError" class="text-sm text-red-600">{{ favoriteError }}</div>

    <div *ngIf="isSearching" class="flex items-center gap-3 text-gray-600">
      <span class="spinner" aria-hidden="true"></span>
      <span>Searching...</span>
    </div>

    <div *ngIf="!isSearching && hasResults" class="flex flex-col gap-4">
      <app-article-card
        *ngFor="let article of results; trackBy: trackByArticleId"
        [article]="article"
        viewMode="list"
        [isBookmarked]="isFavoriteArticle(article)"
        (bookmarkToggle)="toggleFavorite(article)"
        (tagClick)="handleKeywordSelect($event)"
      ></app-article-card>
    </div>

    <div *ngIf="!isSearching && !searchError && !hasResults" class="text-gray-500 text-sm">
      Write or select keywords to see related docs
    </div>

    <section *ngIf="favoriteList.length" class="mt-8 space-y-3">
      <div class="flex items-center justify-between">
        <h2 class="text-lg font-semibold text-gray-800">Favorites</h2>
        <span class="text-sm text-gray-500">{{ favoriteList.length }} article(s) saved</span>
      </div>
      <div class="grid gap-4 md:grid-cols-2">
        <app-article-card
          *ngFor="let article of favoriteList; trackBy: trackByArticleId"
          [article]="article"
          viewMode="grid"
          [isBookmarked]="true"
          (bookmarkToggle)="toggleFavorite(article)"
          (tagClick)="handleKeywordSelect($event)"
        ></app-article-card>
      </div>
    </section>
  </div>
</div>
